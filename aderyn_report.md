# Aderyn Analysis Report

This report was generated by [Aderyn](https://github.com/Cyfrin/aderyn), a static analysis tool built by [Cyfrin](https://cyfrin.io), a blockchain security company. This report is not a substitute for manual audit or security review. It should not be relied upon for any purpose other than to assist in the identification of potential security vulnerabilities.
# Table of Contents

- [Summary](#summary)
  - [Files Summary](#files-summary)
  - [Files Details](#files-details)
  - [Issue Summary](#issue-summary)
- [High Issues](#high-issues)
  - [H-1: `abi.encodePacked()` should not be used with dynamic types when passing the result to a hash function such as `keccak256()`](#h-1-abiencodepacked-should-not-be-used-with-dynamic-types-when-passing-the-result-to-a-hash-function-such-as-keccak256)
  - [H-2: Sending native Eth is not protected from these functions.](#h-2-sending-native-eth-is-not-protected-from-these-functions)
- [Low Issues](#low-issues)
  - [L-1: Centralization Risk for trusted owners](#l-1-centralization-risk-for-trusted-owners)


# Summary

## Files Summary

| Key | Value |
| --- | --- |
| .sol Files | 4 |
| Total nSLOC | 261 |


## Files Details

| Filepath | nSLOC |
| --- | --- |
| src/Ankh.sol | 15 |
| src/Chest.sol | 29 |
| src/MythicChest.sol | 171 |
| src/Prizes.sol | 46 |
| **Total** | **261** |


## Issue Summary

| Category | No. of Issues |
| --- | --- |
| High | 2 |
| Low | 1 |


# High Issues

## H-1: `abi.encodePacked()` should not be used with dynamic types when passing the result to a hash function such as `keccak256()`

Use `abi.encode()` instead which will pad items to 32 bytes, which will [prevent hash collisions](https://docs.soliditylang.org/en/v0.8.13/abi-spec.html#non-standard-packed-mode) (e.g. `abi.encodePacked(0x123,0x456)` => `0x123456` => `abi.encodePacked(0x1,0x23456)`, but `abi.encode(0x123,0x456)` => `0x0...1230...456`). Unless there is a compelling reason, `abi.encode` should be preferred. If there is only one argument to `abi.encodePacked()` it can often be cast to `bytes()` or `bytes32()` [instead](https://ethereum.stackexchange.com/questions/30912/how-to-compare-strings-in-solidity#answer-82739).
If all arguments are strings and or bytes, `bytes.concat()` should be used instead.

<details><summary>2 Found Instances</summary>


- Found in src/Chest.sol [Line: 70](src/Chest.sol#L70)

	```solidity
	        return string(abi.encodePacked(super.uri(tokenId), tokenId.toString(), ".json"));
	```

- Found in src/Prizes.sol [Line: 97](src/Prizes.sol#L97)

	```solidity
	        return string(abi.encodePacked(baseMetadataURI, _id.toString(), ".json"));
	```

</details>



## H-2: Sending native Eth is not protected from these functions.

Introduce checks for `msg.sender` in the function

<details><summary>1 Found Instances</summary>


- Found in src/MythicChest.sol [Line: 328](src/MythicChest.sol#L328)

	```solidity
	    function rescueETH(address _to, uint256 _amount) external onlyRole(DEFAULT_ADMIN_ROLE) {
	```

</details>



# Low Issues

## L-1: Centralization Risk for trusted owners

Contracts have owners with privileged rights to perform admin tasks and need to be trusted to not perform malicious updates or drain funds.

<details><summary>16 Found Instances</summary>


- Found in src/Ankh.sol [Line: 14](src/Ankh.sol#L14)

	```solidity
	contract Ankh is ERC20, ERC20Burnable, AccessControl {
	```

- Found in src/Ankh.sol [Line: 34](src/Ankh.sol#L34)

	```solidity
	    function mint(address to, uint256 amount) external onlyRole(MINTER_ROLE) {
	```

- Found in src/Chest.sol [Line: 13](src/Chest.sol#L13)

	```solidity
	contract Chest is ERC1155, AccessControl {
	```

- Found in src/Chest.sol [Line: 50](src/Chest.sol#L50)

	```solidity
	    function mint(address to, uint256 id, uint256 amount, bytes memory data) external onlyRole(MINTER_ROLE) {
	```

- Found in src/Chest.sol [Line: 58](src/Chest.sol#L58)

	```solidity
	    function burn(address from, uint256 id, uint256 amount) external onlyRole(MINTER_ROLE) {
	```

- Found in src/Chest.sol [Line: 77](src/Chest.sol#L77)

	```solidity
	    function setURI(string memory newuri) external onlyRole(DEFAULT_ADMIN_ROLE) {
	```

- Found in src/MythicChest.sol [Line: 47](src/MythicChest.sol#L47)

	```solidity
	contract MythicChest is AccessControl, ReentrancyGuard, Pausable, VRFConsumerBaseV2 {
	```

- Found in src/MythicChest.sol [Line: 279](src/MythicChest.sol#L279)

	```solidity
	    function setChestPrice(uint256 newPrice) external onlyRole(ADMIN_ROLE) {
	```

- Found in src/MythicChest.sol [Line: 283](src/MythicChest.sol#L283)

	```solidity
	    function pause() external onlyRole(ADMIN_ROLE) {
	```

- Found in src/MythicChest.sol [Line: 287](src/MythicChest.sol#L287)

	```solidity
	    function unpause() external onlyRole(ADMIN_ROLE) {
	```

- Found in src/MythicChest.sol [Line: 294](src/MythicChest.sol#L294)

	```solidity
	    function withdrawRevenue(address to) external onlyRole(DEFAULT_ADMIN_ROLE) {
	```

- Found in src/MythicChest.sol [Line: 314](src/MythicChest.sol#L314)

	```solidity
	    function rescueERC20(address _token, address _to, uint256 _amount) external onlyRole(DEFAULT_ADMIN_ROLE) {
	```

- Found in src/MythicChest.sol [Line: 328](src/MythicChest.sol#L328)

	```solidity
	    function rescueETH(address _to, uint256 _amount) external onlyRole(DEFAULT_ADMIN_ROLE) {
	```

- Found in src/Prizes.sol [Line: 8](src/Prizes.sol#L8)

	```solidity
	contract Prizes is ERC1155, Ownable {
	```

- Found in src/Prizes.sol [Line: 36](src/Prizes.sol#L36)

	```solidity
	    function setMythicChestAddress(address _chestAddress) external onlyOwner {
	```

- Found in src/Prizes.sol [Line: 46](src/Prizes.sol#L46)

	```solidity
	    function setBaseURI(string memory _newURI) external onlyOwner {
	```

</details>





